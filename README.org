#+title: osm.el - OpenStreetMap viewer for Emacs
#+author: Daniel Mendler
#+language: en
#+export_file_name: osm.texi
#+texinfo_dir_category: Emacs
#+texinfo_dir_title: OpenStreetMap: (osm).
#+texinfo_dir_desc: OpenStreetMap viewer for Emacs

#+html: <a href="https://www.gnu.org/software/emacs/"><img alt="GNU Emacs" src="https://github.com/minad/corfu/blob/screenshots/emacs.svg?raw=true"/></a>

[[https://github.com/minad/osm/blob/screenshots/osm.png?raw=true]]
(Map tiles © https://opentopomap.org,  https://openstreetmap.org)

* Features

- Parallel fetching of tiles with curl
- Scrolling in large and small steps
- Zooming with keys or with mouse click
- Map scale indicator
- Jump to coordinate
- Search for location by name
- Org link support
- Bookmarks
- Multiple preconfigured servers

* Configuration

#+begin_src emacs-lisp
  (use-package osm
    :bind (("C-c m h" . osm-home)
           ("C-c m s" . osm-search)
           ("C-c m S" . osm-server)
           ("C-c m g" . osm-goto))
    :init
    ;; Load Org link support
    (with-eval-after-load 'org
      (require 'osm-ol)))
#+end_src

* Bookmarks and Org links

To store a bookmark press the key ~b~, to store Org links press the key ~l~. You can
also use a custom binding, e.g., ~C-c l~. Then the link can be inserted into an Org
buffer with ~C-c C-l~. Bookmarks and Org links can be created at point with the
mouse, see ~osm-bookmark-click~ and ~osm-org-link-click~.

Examples:

- [[osm:opentopomap:44.00862011541535,9.99755859375,6][Italia, 44.01° 10.00° OpenTopoMap]]
- [[osm:51.48950698022105,-0.144195556640625,11][London, England, 51.49° -0.14°]]
- [[osm:cyclosm:55.686875255964424,12.569732666015625,12][København, Danmark, 55.69° 12.57° CyclOSM]]
- [[osm:stamen-watercolor:40.72956780913898,-73.97918701171875,12][New York, United States, 40.73° -73.98° Stamen Watercolor]]
- [[osm:opentopomap:27.961656050984658,86.89224243164062,13][Mount Everest, 27.96° 86.89° OpenTopoMap]]

* Commands and Key Bindings

Top-level commands:
- =osm-home=: Open new map at home coordinates
- =osm-search=: Search and jump to location
- =osm-goto=: Go to coordinates
- =osm-server=: Select server

Key bindings in =osm-mode= buffer:
- ~<arrow>~: Small step scrolling
- ~C-<arrow>~, ~M-<arrow>~: Large step scrolling
- ~+~, ~SPC~: =osm-zoom-in= - Zoom in
- ~-~, ~S-SPC~: =osm-zoom-out= - Zoom out
- ~<mouse-1>~: =osm-zoom-click= - Zoom to point
- ~<mouse-2>~: =osm-org-link-click= - Store point as Org link
- ~<mouse-3>~: =osm-bookmark-click= - Store point as bookmark
- ~g~: =osm-goto= - Go to location
- ~h~: =osm-home= - Go to home location
- ~s~: =osm-search= - Search for location
- ~S~: =osm-server= - Select server
- ~l~: =org-store-link= - Store org link
- ~b~: =osm-bookmark= - Set bookmark
- ~B~: =osm-bookmark-jump= - Jump to bookmark
- ~q~: =quit-window= - Close buffer and window
- ~c~: =clone-buffer= - Clone buffer

* Wishlist

It would be nice to have overlays on top of the map, location markers, routes,
GPS tracks, etc. In the [[https://github.com/minad/osm/tree/svg][svg branch]] I experiment with SVG tiles, composed of the
bitmap background and markers on top.

* Related projects

There have been other attempts at map viewers in Emacs before.

- https://github.com/ruediger/osm-mode
- https://github.com/svenssonjoel/Emacs-OSM
- https://github.com/jd/google-maps.el
